# MarchProxy RTMP Container Configuration Example

# Server settings
host: 0.0.0.0
port: 1935
grpc-port: 50053

# Logging
log-level: info  # debug, info, warn, error

# Encoder configuration
encoder: auto  # auto, x264, x265, nvenc_h264, nvenc_h265, amf_h264, amf_h265
preset: medium  # ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow

# Output settings
output-dir: /var/lib/marchproxy/streams
enable-hls: true
enable-dash: true
segment-duration: 6  # seconds

# FFmpeg paths (optional, auto-detected)
ffmpeg-path: ffmpeg
ffprobe-path: ffprobe

# Encoder-specific parameters (optional)
encoder-params:
  # x264/x265 CPU encoding
  tune: zerolatency
  profile: high
  level: "4.1"

  # NVENC GPU encoding
  # rc: vbr
  # cq: "23"
  # gpu: "0"

  # AMF GPU encoding
  # quality: quality  # speed, balanced, quality

# Rate limiting (per route)
max-bitrate: 10      # Mbps - max output bitrate
max-streams: 100     # concurrent streams allowed
max-resolution: 1080 # max height in pixels

# Health check
health-check-interval: 30  # seconds

# Routes (optional - configured via API)
# routes:
#   - name: stream1
#     stream-key: live_stream_1
#     input-url: rtmp://source:1935/app/stream1
#     output-profiles:
#       - 1080p
#       - 720p
#       - 480p
#     enabled: true
#
#   - name: stream2
#     stream-key: live_stream_2
#     input-url: rtmp://source:1935/app/stream2
#     output-profiles:
#       - 720p
#       - 480p
#     enabled: true
